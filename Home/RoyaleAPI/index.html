<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CR Player Info</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f4f4f4;
    }
    input, button {
      padding: 0.5rem;
      margin-right: 1rem;
    }
    #result {
      margin-top: 1rem;
      white-space: pre-wrap;
      background: #fff;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <header>
    <h1>Welcome to Clash Royale API</h1>
  </header>

  <main>
    <p>Please enter a player tag (with or without #):</p>
  </main>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const main = document.querySelector("main");

    const input = document.createElement("input");
    input.id = "playerId";
    input.placeholder = "Player Tag (e.g. #2PP)";
    main.appendChild(input);

    const button = document.createElement("button");
    button.textContent = "Get Player Info";
    main.appendChild(button);

    const resultDiv = document.createElement("div");
    resultDiv.id = "result";
    main.appendChild(resultDiv);

    button.addEventListener("click", async () => {
      let tag = input.value.trim().toUpperCase();
      if (!tag) {
        resultDiv.textContent = "Please enter a player tag.";
        return;
      }
      resultDiv.textContent = "Loading...";

      const apiBase =
        location.hostname === "localhost" || location.hostname === "127.0.0.1"
          ? "http://localhost:10000"
          : "https://rohmju-github-io.onrender.com"; // âœ… Correct backend for production

      try {
        const response = await fetch(`${apiBase}/api/player/${encodeURIComponent(tag)}`);
        if (!response.ok) {
          const errData = await response.json().catch(() => ({}));
          throw new Error(errData.error || "API error: " + response.status);
        }

        const data = await response.json();
        resultDiv.textContent = JSON.stringify(data, null, 2);
        console.log("API Response:", data);
      } catch (error) {
        resultDiv.textContent = "Error: " + error.message;
        console.error("API Error:", error);
      }
    });
  });
  </script>

</body>
</html>
